# 基于规则引导的半监督日志异常检测系统

本项目旨在构建一个面向 Web 访问日志的异常检测系统，综合利用规则评分机制和半监督学习算法，从大规模原始日志中识别潜在的恶意访问行为。项目实现了从数据提取、规则构建、伪标签生成、模型训练到半监督迭代的完整流程，并在公开数据集上取得了良好的性能表现。

## 一、项目背景

随着网络攻击行为的日益复杂，传统依赖人工标注或完全无监督的检测方式已难以满足需求。为此，项目尝试采用“规则引导 + 伪标签 + 半监督模型”的方式，以较低的人工成本完成大规模数据的建模与分类。

## 二、数据来源

- 数据集来自 Kaggle：
  - [Web Server Access Logs](https://www.kaggle.com/datasets/eliasdabbas/web-server-access-logs)
- 原始日志为 `.log` 文件，采用正则表达式进行字段提取，主要字段包括：
  - IP
  - Time
  - Method
  - Path
  - Status
  - Size
  - Referer
  - User-Agent

## 三、数据处理流程

1. **日志字段解析**：使用正则表达式提取日志结构化信息。
2. **规则评分系统**：设计若干规则（路径长度、状态码、特殊符号、User-Agent异常等）为每条记录赋予评分。
3. **伪标签生成**：根据得分阈值划分“可疑/正常”数据，生成初步伪标签。
4. **样本均衡处理**：从上千万条数据中抽取足量数据，使得正负样本数量平衡（如20万：20万）。
5. **特征构造与向量化**：对字符串特征（如path、user-agent）进行清洗与编码，准备输入模型。

## 四、建模方案

### 1. 监督学习对比

- 模型：朴素贝叶斯、逻辑回归、XGBoost
- 实验发现 XGBoost 在该任务中表现最佳，准确率达 0.99，且经过学习曲线验证，未出现过拟合。

### 2. 半监督学习流程

- 初始模型基于伪标签训练
- 在大量未标注数据上预测，筛选置信度高的预测结果加入训练集
- 迭代训练模型以进一步优化分类性能
- 最终模型在测试集上的准确率仍保持 0.99，说明该策略在该数据场景下具有良好泛化能力

## 五、项目成果

- 构建了基于规则引导的异常评分系统
- 实现了从伪标签生成到半监督迭代训练的完整流程
- 成功处理数百万级别的访问日志数据
- 构建模型准确率达 99%，未出现明显过拟合现象
- 加深了对日志结构、安全事件特征及半监督学习方法的理解

## 六、依赖环境

- Python 3.x
- pandas
- numpy
- scikit-learn
- xgboost
- tqdm

## 七、使用说明（可选）

如需复现本项目，建议使用 Google Colab 或 Kaggle Notebook，以避免因本地资源限制导致训练失败。你可以将以下模块独立执行：

1. 数据解析与规则评分
2. 伪标签生成与样本均衡
3. 模型训练与评估（XGBoost）
4. 半监督迭代与最终预测

这只是简单的学习尝试，并未涉及复杂考量，请注意！！！

## 八、致谢

感谢开源数据集的贡献者，以及机器学习社区提供的丰富学习资源。本项目所有实验基于公开数据和自建规则完成，研究仅供学习使用。
